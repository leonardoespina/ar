<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Carta 3D Restaurante</title>

<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>

<style>
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  body {
    font-family: system-ui, sans-serif;
    background: #0f172a;
    color: #e2e8f0;
    touch-action: none;
    overflow: hidden;
    height: 100vh;
    width: 100vw;
  }

  .card {
    background: url("3.jpg") no-repeat center center;
    background-size: cover;
    width: 100%;
    height: 100vh;
    position: relative;
    display: flex;
    flex-direction: column;
  }

  .card::before {
    content: "";
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.4);
    z-index: 0;
  }

  .model-container {
    width: 100%;
    flex-grow: 1;
    position: relative;
    z-index: 1;
    touch-action: none;
  }

  model-viewer {
    width: 100%;
    height: 100%;
    background-color: transparent;
    touch-action: none;
    --progress-bar-color: transparent;
  }

  .loader {
    position: absolute;
    inset: 0;
    background: rgba(15,23,42,0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.2rem;
    font-weight: bold;
    z-index: 2;
    display: none;
  }

  /* Área de texto con efecto vidrio - versión mobile */
  .card-info {
    padding: 1.5rem 1rem;
    position: relative;
    z-index: 1;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-top: 1px solid rgba(255, 255, 255, 0.2);
    flex-shrink: 0;
  }

  .card-title {
    font-size: 1.8rem;
    font-weight: bold;
    margin-bottom: 0.5rem;
    color: white;
  }

  .card-price {
    color: #22c55e;
    font-weight: bold;
    font-size: 1.5rem;
    margin-bottom: 0.5rem;
  }

  .card-rating {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 1rem;
    color: rgba(255, 255, 255, 0.9);
    font-size: 1rem;
  }

  .card-ingredients {
    font-size: 1rem;
    color: rgba(255, 255, 255, 0.9);
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-top: 0.5rem;
  }

  .ingredient-tag {
    background: rgba(255, 255, 255, 0.2);
    padding: 0.5rem 0.8rem;
    border-radius: 999px;
    font-size: 0.9rem;
  }

  /* Flechas - versión mobile */
  .swiper-button-next, .swiper-button-prev {
    color: white;
    position: fixed;
    top: 50%;
    transform: translateY(-50%);
    z-index: 20;
    touch-action: auto;
    width: 50px;
    height: 50px;
    background: rgba(0,0,0,0.3);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .swiper-button-next { right: 15px; }
  .swiper-button-prev { left: 15px; }

  /* Media queries para tablets en orientación horizontal */
  @media (min-width: 768px) and (orientation: landscape) {
    .card {
      max-width: 450px;
      max-height: 90vh;
      margin: auto;
      border-radius: 16px;
    }
    
    .card-info {
      border-radius: 0 0 16px 16px;
    }
  }

  /* Media queries para pantallas grandes */
  @media (min-width: 1024px) {
    .card {
      max-width: 400px;
      max-height: 700px;
    }
  }
</style>
</head>
<body>

<div class="card">
  <div class="model-container">
    <div class="loader" id="loader">Cargando...</div>
    <model-viewer
      id="viewer"
      src="models/leo.glb"
      alt="Modelo"
      camera-controls
      shadow-intensity="1"
      auto-rotate
      interaction-policy="allow-when-focused"
      touch-action="none"
      ar-status="not-presenting">
    </model-viewer>
  </div>
  <div class="card-info">
    <div class="card-title" id="title">Cappuccino</div>
    <div class="card-price" id="price">$4.50</div>
    <div class="card-rating">
      <span>★ 4.5</span>
      <span>(6,986)</span>
    </div>
    <div class="card-ingredients">
      <span class="ingredient-tag">Coffee</span>
      <span class="ingredient-tag">Milk</span>
      <span class="ingredient-tag">Micilum Roasted</span>
    </div>
  </div>
</div>

<div class="swiper-button-prev"></div>
<div class="swiper-button-next"></div>

<script>
  const models = [
    { 
      src: "models/leo.glb", 
      title: "Cappuccino", 
      price: "$4.50", 
      rating: "4.5 (6,986)",
      ingredients: ["Coffee", "Milk", "Micilum Roasted"]
    },
    { 
      src: "models/2.glb", 
      title: "Hamburguesa Clásica", 
      price: "$9.90", 
      rating: "4.8 (3,452)",
      ingredients: ["Carne", "Queso", "Lechuga", "Tomate"]
    },
    { 
      src: "models/3.glb", 
      title: "Ensalada César", 
      price: "$7.50", 
      rating: "4.3 (2,156)", 
      ingredients: ["Lechuga", "Pollo", "Parmesano", "Aderezo"]
    }
  ];

  let currentIndex = 0;
  const viewer = document.getElementById("viewer");
  const loader = document.getElementById("loader");
  const titleEl = document.getElementById("title");
  const priceEl = document.getElementById("price");
  const ingredientsEl = document.querySelector(".card-ingredients");
  const ratingEl = document.querySelector(".card-rating");

  // Prevenir zoom con doble toque
  document.addEventListener('dblclick', function(e) {
    e.preventDefault();
  }, { passive: false });

  // Prevenir desplazamiento
  document.addEventListener('touchmove', function(e) {
    const isNavigationButton = e.target.closest('.swiper-button-next') || 
                              e.target.closest('.swiper-button-prev');
    if (!isNavigationButton) {
      e.preventDefault();
    }
  }, { passive: false });

  function loadModel(index) {
    const model = models[index];
    loader.style.display = "flex";
    titleEl.textContent = model.title;
    priceEl.textContent = model.price;
    ratingEl.innerHTML = `★ ${model.rating}`;
    
    ingredientsEl.innerHTML = model.ingredients
      .map(ing => `<span class="ingredient-tag">${ing}</span>`)
      .join('');

    viewer.addEventListener("load", () => {
      loader.style.display = "none";
      viewer.autoRotate = true;
      // Ajustar campo de visión para móviles
      if (window.innerWidth <= 768) {
        viewer.fieldOfView = '45deg';
      }
    }, { once: true });
    
    viewer.src = model.src;
  }

  // Navegación táctil mejorada
  document.querySelector(".swiper-button-next").addEventListener("click", (e) => {
    e.stopPropagation();
    currentIndex = (currentIndex + 1) % models.length;
    loadModel(currentIndex);
  });

  document.querySelector(".swiper-button-prev").addEventListener("click", (e) => {
    e.stopPropagation();
    currentIndex = (currentIndex - 1 + models.length) % models.length;
    loadModel(currentIndex);
  });

  // Gestos táctiles para cambiar modelo
  let touchStartX = 0;
  document.addEventListener('touchstart', (e) => {
    touchStartX = e.touches[0].clientX;
  }, { passive: true });

  document.addEventListener('touchend', (e) => {
    const touchEndX = e.changedTouches[0].clientX;
    const diffX = touchStartX - touchEndX;
    
    // Umbral para considerar un deslizamiento
    if (Math.abs(diffX) > 50) {
      if (diffX > 0) {
        // Deslizamiento a la izquierda (siguiente)
        currentIndex = (currentIndex + 1) % models.length;
      } else {
        // Deslizamiento a la derecha (anterior)
        currentIndex = (currentIndex - 1 + models.length) % models.length;
      }
      loadModel(currentIndex);
    }
  }, { passive: true });

  // Cargar modelo inicial
  loadModel(currentIndex);

  // Ajustar al cambiar orientación
  window.addEventListener('orientationchange', () => {
    setTimeout(() => {
      if (window.innerWidth <= 768) {
        viewer.fieldOfView = '45deg';
      } else {
        viewer.fieldOfView = '30deg';
      }
    }, 300);
  });
</script>

</body>
</html>


