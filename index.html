<!-- <html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <style>
      body { 
        margin: 0; 
        overflow: hidden; 
        touch-action: none;
      }
      #interaction-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 9999;
      }
    </style>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
    <script src="https://unpkg.com/aframe-gestures-component@3.0.1/dist/aframe-gestures-component.min.js"></script>
  </head>
  <body>
    <div id="interaction-overlay"></div>
    
    <a-scene
      mindar-image="imageTargetSrc: targets/targets.mind;"
      vr-mode-ui="enabled: false"
      renderer="colorManagement: true"
    >
      <a-assets>
        <a-asset-item id="avatarModel" src="models/1.glb"></a-asset-item>
      </a-assets>

      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <a-entity mindar-image-target="targetIndex: 0">
        <a-gltf-model
          id="interactiveModel"
          rotation="0 0 0"
          position="0 -1 0"
          scale="1 1 1"
          src="#avatarModel"
          gesture-handler="minScale: 0.5; maxScale: 2;"
          pinchable
          stretchable
          rotatable
        ></a-gltf-model>
      </a-entity>
    </a-scene>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const scene = document.querySelector('a-scene');
        const model = document.getElementById('interactiveModel');
        const overlay = document.getElementById('interaction-overlay');
        
        // Variables para control de gestos
        let isTracking = false;
        let initialScale = { x: 1, y: 1, z: 1 };
        let initialDistance = null;
        let initialRotation = { x: 0, y: 0, z: 0 };
        let initialAngle = null;
        let lastTouch = null;
        
        // Evento cuando se detecta el target
        scene.addEventListener('targetFound', () => {
          isTracking = true;
        });
        
        // Evento cuando se pierde el target
        scene.addEventListener('targetLost', () => {
          isTracking = false;
        });
        
        // Control de gestos táctiles
        overlay.addEventListener('touchstart', function(e) {
          if (!isTracking) return;
          e.preventDefault();
          
          if (e.touches.length === 2) {
            // Dos dedos: rotación y escala
            initialDistance = getDistance(e.touches[0], e.touches[1]);
            initialScale = model.getAttribute('scale');
            initialAngle = getAngle(e.touches[0], e.touches[1]);
            initialRotation = model.getAttribute('rotation');
          } else if (e.touches.length === 1) {
            // Un dedo: rotación
            lastTouch = {
              x: e.touches[0].clientX,
              y: e.touches[0].clientY
            };
          }
        });
        
        overlay.addEventListener('touchmove', function(e) {
          if (!isTracking) return;
          e.preventDefault();
          
          if (e.touches.length === 2) {
            // Gestos con dos dedos
            const currentDistance = getDistance(e.touches[0], e.touches[1]);
            const currentAngle = getAngle(e.touches[0], e.touches[1]);
            
            // Escalado
            const scaleFactor = currentDistance / initialDistance;
            const newScale = {
              x: Math.min(Math.max(initialScale.x * scaleFactor, 0.5), 2),
              y: Math.min(Math.max(initialScale.y * scaleFactor, 0.5), 2),
              z: Math.min(Math.max(initialScale.z * scaleFactor, 0.5), 2)
            };
            model.setAttribute('scale', newScale);
            
            // Rotación
            const angleDiff = currentAngle - initialAngle;
            const newRotation = {
              y: initialRotation.y + angleDiff * 2,
              x: initialRotation.x,
              z: initialRotation.z
            };
            model.setAttribute('rotation', newRotation);
          } else if (e.touches.length === 1 && lastTouch) {
            // Rotación con un dedo
            const deltaX = e.touches[0].clientX - lastTouch.x;
            const currentRotation = model.getAttribute('rotation');
            
            model.setAttribute('rotation', {
              y: currentRotation.y + deltaX * 0.5,
              x: currentRotation.x,
              z: currentRotation.z
            });
            
            lastTouch = {
              x: e.touches[0].clientX,
              y: e.touches[0].clientY
            };
          }
        });
        
        overlay.addEventListener('touchend', function(e) {
          lastTouch = null;
          initialDistance = null;
          initialAngle = null;
        });
        
        // Funciones auxiliares
        function getDistance(touch1, touch2) {
          const dx = touch1.clientX - touch2.clientX;
          const dy = touch1.clientY - touch2.clientY;
          return Math.sqrt(dx * dx + dy * dy);
        }
        
        function getAngle(touch1, touch2) {
          const dx = touch2.clientX - touch1.clientX;
          const dy = touch2.clientY - touch1.clientY;
          return Math.atan2(dy, dx) * 180 / Math.PI;
        }
      });
    </script>
  </body>
</html>
 
 <html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
  </head>
  <body>
    <a-scene
      mindar-image="imageTargetSrc: targets/targets.mind;"
      color-space="sRGB"
      renderer="colorManagement: true,
physicallyCorrectLights"
      vr-mode-ui="enabled: false"
      device-orientation-permission-ui="enabled: false"
    >
      <a-assets>
        <a-asset-item id="avatarModel" src="models/1.glb"></a-asset-item>
      </a-assets>

      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <a-entity mindar-image-target="targetIndex: 0">
        <a-gltf-model
          rotation="0 0 0 "
          position="0 -1 0"
          src="#avatarModel"
        ></a-gltf-model>
      </a-entity>
    </a-scene>
  </body>
</html>
 -->
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
    <style>
      body {
        margin: 0;
        overflow: hidden;
        touch-action: none;
        background-color: #000;
      }
      .controls {
        position: absolute;
        bottom: 20px;
        width: 100%;
        display: flex;
        justify-content: center;
        gap: 20px;
        z-index: 1000;
      }
      .control-btn {
        background-color: rgba(255,255,255,0.3);
        color: white;
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        font-size: 24px;
        backdrop-filter: blur(5px);
      }
    </style>
  </head>
  <body>
    <a-scene
      mindar-image="imageTargetSrc: targets/targets.mind;"
      color-space="sRGB"
      renderer="colorManagement: true; physicallyCorrectLights: true; antialias: true"
      vr-mode-ui="enabled: false"
      device-orientation-permission-ui="enabled: false"
    >
      <a-assets>
        <a-asset-item id="foodModel" src="models/1.glb"></a-asset-item>
      </a-assets>

      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <!-- Entorno para mejorar la percepción de profundidad -->
      <a-entity geometry="primitive: plane; width: 2; height: 2" 
                material="color: #333; shader: flat"
                position="0 -0.5 0"
                rotation="-90 0 0"
                shadow="receive: true"></a-entity>

      <a-entity mindar-image-target="targetIndex: 0">
        <a-entity 
          id="food-dish"
          gltf-model="#foodModel"
          scale="1 1 1"
          position="0 0 0"
          rotation="-15 0 0"
          shadow="cast: true; receive: true"
        >
          <!-- Efecto de profundidad adicional -->
          <a-entity position="0 -0.05 0" 
                    geometry="primitive: plane; width: 0.8; height: 0.8" 
                    material="color: #000; opacity: 0.3; shader: flat"
                    rotation="-90 0 0"
                    shadow="receive: true"></a-entity>
        </a-entity>
      </a-entity>
      
      <div class="controls">
        <button class="control-btn" id="zoom-in">+</button>
        <button class="control-btn" id="zoom-out">-</button>
        <button class="control-btn" id="depth-effect">∞</button>
      </div>
      
      <!-- Sistema de luces mejorado -->
      <a-entity light="type: ambient; color: #FFF; intensity: 0.5"></a-entity>
      <a-entity light="type: directional; color: #FFF; intensity: 1.2" position="-1 2 1" shadow="castShadow: true; shadowMapWidth: 2048; shadowMapHeight: 2048"></a-entity>
      <a-entity light="type: directional; color: #FFEEDD; intensity: 0.5" position="1 1 1"></a-entity>
      
      <!-- Efecto de niebla para profundidad -->
      <a-entity environment="fog: 0.5; fogColor: #000; groundColor: #333; grid: cross"></a-entity>
    </a-scene>

    <script>
      const foodDish = document.querySelector('#food-dish');
      const zoomInBtn = document.getElementById('zoom-in');
      const zoomOutBtn = document.getElementById('zoom-out');
      const depthBtn = document.getElementById('depth-effect');
      
      let currentScale = 1.0;
      let depthEnabled = true;
      
      // Configuración inicial para profundidad
      function setupDepthEffects() {
        // Añadir sombras y efectos de profundidad
        const scene = document.querySelector('a-scene');
        scene.setAttribute('renderer', 'shadow: true');
        
        // Configurar rotación inicial para mejor visualización
        foodDish.setAttribute('rotation', '-15 0 0');
        
        // Habilitar efectos de profundidad
        toggleDepthEffects(true);
      }
      
      // Alternar efectos de profundidad
      function toggleDepthEffects(enabled) {
        depthEnabled = enabled;
        const scene = document.querySelector('a-scene');
        
        if (enabled) {
          scene.setAttribute('environment', 'fog: 0.5; fogColor: #000; groundColor: #333; grid: cross');
          scene.setAttribute('renderer', 'shadow: true');
          depthBtn.style.backgroundColor = 'rgba(255,255,255,0.5)';
        } else {
          scene.setAttribute('environment', '');
          scene.setAttribute('renderer', 'shadow: false');
          depthBtn.style.backgroundColor = 'rgba(255,255,255,0.2)';
        }
      }
      
      // Controles de zoom
      zoomInBtn.addEventListener('click', () => {
        currentScale = Math.min(currentScale + 0.1, 1.5);
        foodDish.setAttribute('scale', `${currentScale} ${currentScale} ${currentScale}`);
      });
      
      zoomOutBtn.addEventListener('click', () => {
        currentScale = Math.max(currentScale - 0.1, 0.5);
        foodDish.setAttribute('scale', `${currentScale} ${currentScale} ${currentScale}`);
      });
      
      // Control de efectos de profundidad
      depthBtn.addEventListener('click', () => {
        toggleDepthEffects(!depthEnabled);
      });
      
      // Interacción táctil para rotación
      let isDragging = false;
      let previousPosition = { x: 0 };
      let currentRotation = 0;
      
      window.addEventListener('touchstart', (e) => {
        isDragging = true;
        previousPosition.x = e.touches[0].clientX;
        document.querySelector('.controls').style.opacity = '1';
      });
      
      window.addEventListener('touchmove', (e) => {
        if(!isDragging) return;
        
        const deltaX = e.touches[0].clientX - previousPosition.x;
        currentRotation += deltaX * 0.5;
        foodDish.setAttribute('rotation', `-15 ${currentRotation} 0`);
        
        previousPosition.x = e.touches[0].clientX;
      });
      
      window.addEventListener('touchend', () => {
        isDragging = false;
        setTimeout(() => {
          document.querySelector('.controls').style.opacity = '0';
        }, 3000);
      });
      
      // Inicialización
      window.addEventListener('load', () => {
        setupDepthEffects();
        document.querySelector('.controls').style.opacity = '0';
      });
    </script>
  </body>
</html>
