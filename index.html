<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Carta 3D Restaurante</title>

<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>

<style>
  body {
    font-family: system-ui, sans-serif;
    margin: 0;
    background: #0f172a;
    color: #e2e8f0;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    touch-action: none; /* Evita el desplazamiento en dispositivos táctiles */
    overflow: hidden; /* Previene el scroll */
  }

  .card {
    background: url("3.jpg") no-repeat center center;
    background-size: cover;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.4);
    width: 350px;
    height: 500px;
    overflow: hidden;
    position: relative;
  }

  .card::before {
    content: "";
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.4);
    z-index: 0;
  }

  .model-container {
    width: 100%;
    height: 60%;
    position: relative;
    z-index: 1;
  }

  model-viewer {
    width: 100%;
    height: 100%;
    background-color: transparent;
  }

  /* Loader solo sobre el modelo */
  .loader {
    position: absolute;
    inset: 0;
    background: rgba(15,23,42,0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.2rem;
    font-weight: bold;
    z-index: 2;
    display: none;
  }

  .card-info {
    padding: 1rem;
    position: relative;
    z-index: 1;
  }

  .card-title {
    font-size: 1.25rem;
    font-weight: bold;
  }

  .card-price {
    color: #22c55e;
    font-weight: bold;
  }

  .card-ingredients {
    font-size: 0.9rem;
    color: #f1f5f9;
  }

  /* Flechas */
  .swiper-button-next, .swiper-button-prev {
    color: white;
    position: fixed;
    top: 50%;
    transform: translateY(-50%);
    z-index: 20;
  }
  .swiper-button-next { right: 20px; }
  .swiper-button-prev { left: 20px; }
</style>
</head>
<body>

<div class="card">
  <div class="model-container">
    <div class="loader" id="loader">Cargando...</div>
    <model-viewer
      id="viewer"
      src="models/leo.glb"
      alt="Modelo"
      camera-controls
      shadow-intensity="1"
      auto-rotate
      touch-action="none" <!-- Deshabilita gestos táctiles para el modelo -->
     
      >
    </model-viewer>
  </div>
  <div class="card-info">
    <div class="card-title" id="title">Pizza Margarita</div>
    <div class="card-price" id="price">$12.50</div>
    <div class="card-ingredients" id="ingredients">Tomate, mozzarella, albahaca</div>
  </div>
</div>

<div class="swiper-button-prev"></div>
<div class="swiper-button-next"></div>

<script>
  const models = [
    { src: "models/leo.glb", title: "Pizza Margarita", price: "$12.50", ingredients: "Tomate, mozzarella, albahaca" },
    { src: "models/2.glb", title: "Hamburguesa Clásica", price: "$9.90", ingredients: "Carne, queso, lechuga, tomate" },
    { src: "models/3.glb", title: "Ensalada César", price: "$7.50", ingredients: "Lechuga, pollo, parmesano, aderezo" }
  ];

  let currentIndex = 0;
  const viewer = document.getElementById("viewer");
  const loader = document.getElementById("loader");
  const titleEl = document.getElementById("title");
  const priceEl = document.getElementById("price");
  const ingredientsEl = document.getElementById("ingredients");

  // Prevenir eventos táctiles en el documento
  document.addEventListener('touchmove', function(e) {
    if (!e.target.classList.contains('swiper-button-next') && 
        !e.target.classList.contains('swiper-button-prev')) {
      e.preventDefault();
    }
  }, { passive: false });

  function loadModel(index) {
    const model = models[index];
    loader.style.display = "flex"; // Mostrar loader sobre el modelo
    titleEl.textContent = model.title;
    priceEl.textContent = model.price;
    ingredientsEl.textContent = model.ingredients;

    // Escuchar evento antes de cambiar src
    viewer.addEventListener("load", onModelLoad, { once: true });
    viewer.src = model.src;
  }

  function onModelLoad() {
    loader.style.display = "none";
  }

  document.querySelector(".swiper-button-next").addEventListener("click", (e) => {
    e.stopPropagation();
    currentIndex = (currentIndex + 1) % models.length;
    loadModel(currentIndex);
  });

  document.querySelector(".swiper-button-prev").addEventListener("click", (e) => {
    e.stopPropagation();
    currentIndex = (currentIndex - 1 + models.length) % models.length;
    loadModel(currentIndex);
  });

  // Cargar el modelo inicial
  loadModel(currentIndex);
</script>

</body>
</html>

